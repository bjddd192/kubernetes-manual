# 版本使用记录

## 时间轴

- 2016.04 docker 容器化研究
- 2016.05 docker 私仓建立
- 2016.07 基础组件容器化完毕
- 2016.09 使用 docker run + 在宿主机上映射war包的方式，实现了第一版的“容器化”
- 2016.10 Kubernetes 1.4 版本预研
- 2017.03 Kubernetes 1.4 版本开发集群搭建
- 2017.05 引入 spring boot 框架，实现应用在 jenkins 上构建应用镜像包，通过 k8s 来发布，实现了第二版部分新应用的容器化
- 2017.07 Kubernetes 1.4 版本生产集群搭建
- 2017.09 Kubernetes 1.7 安装部署方式对比研究
- 2017.11 引入 spring cloud 体系，并改造老工程，实现了第三版真正意义上的应用全容器化
- 2018.02 使用 kubeasz 项目集成 Kubernetes 1.9 版本的安装部署（升级网络组件 weave 为 calico，集成 prometheus、zabbix 监控工具）
- 2018.05 使用 kubeasz 项目升级开发 Kubernetes 集群为 1.9.6 高可用集群
- 2018.06 应用去 dubbo，全部使用 spring cloud 体系 
- 2018.07 使用 kubeasz 项目升级生产 Kubernetes 集群为 1.9.6 高可用集群
- 2018.09 kubeasz 项目新增 EFK 的部署并在开发集群启用
- 2018.11.08 洪大师以非技术角度给大家分享公司为什么迫切需要使用k8s

## 工作历程

### 2018.10

公司内部大力推进容器化进程，以 scm 项目作为新的试点，搭建新环境

scm 开发环境容器化推进进度
1. 镜像仓库构建（完成）
2. k8s 集群搭建（完成）【目前为3主5从】
3. k8s 集群验证（完成）【测试应用正常运行、容器间网络连通正常、集群资源运行正常】
4. k8s 基础组件 - dashboard 安装（完成）
5. 容器化发布基础组件：文件下载服务、镜像仓库web查看工具、jenkins（完成）
6. k8s 应用部署组件安装（完成）
7. petrel 基础组件在 jenkins 构建并连接 k8s 应用部署组件自动发布（完成）
8. 初始化 k8s-easy 项目，并上传到公司到 gitlab 服务器（完成）
9. petrel 基础工程在 k8s 环境运行联调（完成90%）
10. 镜像仓库切换 harbor 仓库（完成60%）

### 2018.12.14

Docker化推进双周会议纪要

参会人员：ToB货品&BI系统部、零售营销系统部、财务&后台系统部、供应链系统部docker化推进负责人、王飞

会议主要内容：
1、本双周进展和总结
	1.1 开发环境：
		制造项目开发环境已经开始迁移到集群，核心应用已全部迁移到鹏博士两台周转物理机上，还有部分应用待迁移完成；
		TMS应用已完成容器化部署，WMS完成大部分应用容器化部署；
		店铺系统、FAS应用已经完成容器化部署；
		IDC应用已完成容器化部署，UC还在调试；
		深圳机房需要一台 jenkins 节点机器；
	1.2 测试环境
		测试环境两台应用机器已加入集群；
		测试环境需要一台 jenkins 节点机器；
		topmall测试环境的部署(待王飞跟洪大师支持)；
	1.3 公共组件
		开发、测试环境共用镜像仓库，使用不同的harbor工程名进行区分；
		redis、mongodb 等尽可能使用公司统一提供的平台环境；
	1.4 k8s 集群环境
		集群目前支持自定义DNS解析，可以将部分开发内部DNS解析加入开发自定义的DNS服务器，支持集群内部容器的DNS访问需求；
		Helm 统一使用深圳的 harbor 仓库；
		制造项目迁移后部分开发机器需要加入集群；
		TMS部分开发机器需要释放后加入集群；
		IDC部分开发机器需要释放后加入集群；
		集群内 ingress 的使用(洪大师先选型使用再推广)
2、下一步工作重点
	topmall测试环境容器化的部署



## 新版本重要功能

### 1.10

- 应用程序编程接口(API)聚合现在在 Kubernetes 1.10 中是稳定的。这使得 Kubernetes 开发人员可以开发自己的自定义API服务器，无需更改核心 Kubernetes 代码库。有了这个特性，Kubernetes 集群管理员可以更放心地在生产环境配置中将这些第三方API添加到集群中。

### 1.11

- 管理员现在可以改变一组容器可用的数据存储量，而无需先关闭容器和先卸载现有的存储容量。其结果是减少了停机时间，这将使企业在操作需求发生变化时更容易更新容器集群。
- 增加了对名为 CoreDNS 的新域名服务器系统的支持。根据发行说明，它具有“比以前DNS服务器更少的移动部件”，以及具有自定义选项可实现更广泛的用例。 

### 1.12

- 继续关注内部改进与功能完善，旨在进一步提升与 Kubernetes 对接时的稳定性。这一最新版本亦在安全性与 Azure 等关键功能上做出增强。
- 将带来更强大的安全性、可用性、弹性以及易用性